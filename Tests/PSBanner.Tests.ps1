Import-Module Pester
Import-Module (Join-Path (Split-Path $PSScriptRoot -Parent) "\PSBanner") -Force
#
# Are these tests realy useful?
#
Describe "Write-Banner" {
    It "if the argument is single string, returns correct value." {
        Write-Banner 'Hello' | Out-String | Should Be @"
                                     
                                     
                                     
               #####   ####          
###  ##          ###    ###          
###  ##          ###    ###          
###  ##  #####   ###    ###   ###### 
####### ##  ##   ###    ###  ###  ## 
###  #########   ###    ###  ###  ###
###  #####       ###    ###  ###  ###
###  ## ###      ###    ###  ### ### 
###  ## ###### ############## #####  
                                     
                                     
                                     
                                     


"@
    }
    It "if the argument is multi string, returns correct value." {
        Write-Banner  Hello World | Out-String | Should Be @"
                                                                                 
                                                                                 
                                                                                 
               #####   ####                                        ####       ## 
###  ##          ###    ###                 ##   ###                ###       ## 
###  ##          ###    ###                 ##   ###                ###       ## 
###  ##  #####   ###    ###   ######        ##   ## ###### ######   ###    ##### 
####### ##  ##   ###    ###  ###  ##        ##########  ## ### ###  ###   ##  ## 
###  #########   ###    ###  ###  ###       ##########  ######      ###  ###  ## 
###  #####       ###    ###  ###  ###       ##########  ######      ###  ###  ## 
###  ## ###      ###    ###  ### ###        ########## ### ###      ###  ### ### 
###  ## ###### ############## #####         ### ### #####  ###    ####### ###### 
                                                                                 
                                                                                 
                                                                                 
                                                                                 


"@
    }
    It "FontSize parameter works fine." {
        Write-Banner Hello -FontSize 16 | Out-String | Should Be @"
                                                           
                                                           
                                                           
                                                           
                                                           
                                                           
                         ######      ######                
####    ###              ######      ######                
####    ###                 ###         ###                
####    ###                 ###         ###                
####    ###    #####        ###         ###       ######   
####    ###  #########      ###         ###     #########  
###########  ###   ###      ###         ###     ####  #### 
########### ####   ####     ###         ###    ####    ### 
####    ### ###########     ###         ###    ####    ### 
####    ### ###########     ###         ###    ###     ### 
####    ### ###             ###         ###    ####    ### 
####    ###  ###            ###         ###     ####  #### 
####    ###  #########  ##########  ##########  #########  
####    ###   ########  ##########  ##########    ######   
                                                           
                                                           
                                                           
                                                           
                                                           


"@
    }
    It "Bold,Italic,Underline,Strikeout parameters work fine." {
        Write-Banner Hello -FontSize 16 -Bold -Italic -Underline -Strikeout | Out-String | Should Be @"
                                                           
                                                           
                                                           
                                                           
                                                           
                                                           
                           ####        ####                
  ####   ####              ####        ####                
  ####   ####              ####       ####                 
 ####   ####               ####       ####                 
 ####   ####   #######    ####        ####        #######  
 ####   ####  #########   ####        ####       ######### 
 ########### ####  ####   ####        ####      ##### #####
 ###############   ####   ####       ####      #####   ####
###########################################################
###########################################################
####   #### ####         ####        ####      ####   #### 
####   #### ####         ####  ###   ####  ##  ####  ##### 
####   #### #########    #########   ########  ##########  
###   ####    #######     ######      ######     ######    
                                                           
                                                           
###########################################################
###########################################################
                                                           


"@
    }
    It "Stream parameter works fine." {
        (Write-Banner Hello | Measure-Object).Count | Should Be 1
        (Write-Banner Hello -Stream | Measure-Object).Count | Should Be 16
    }
}